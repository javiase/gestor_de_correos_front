# Email Page i18n Progress

## ‚úÖ Completado (100%)

### i18n.js - Translation Keys
- **Spanish Section (lines 418-575)**: 150+ keys added
  - Viewer & Navigation (8 keys)
  - Reply controls (7 keys)
  - Attachments (5 keys)
  - Preview modal (5 keys)
  - Loading states (2 keys)
  - Shopify Sidebar (15 keys)
  - Order Card (15 keys)
  - Customer Card (4 keys)
  - Secondary Panels (3 keys)
  - Action Bar (4 keys)
  - Refund Modal (35 keys)
  - Store Credit Warning (3 keys)
  - Discount Modal (25 keys)
  - Order association (4 keys)
  - Refund errors (4 keys)
  - Send/Delete notifications (4 keys)

- **English Section (lines 1315-1485)**: Mirror translations of all Spanish keys

### email.html - Static HTML
- **Sidebar toggle button** (line 118): `data-i18n-title="email.toggleSidebarInfo"`
- **Action bar buttons** (lines 137-151): 4 buttons translated
- **Refund Modal** (lines 166-290): ~25 data-i18n attributes
  - Header, unfulfilled badge, items section
  - Shipping section (checkbox, input, max label)
  - Reason field (label, placeholder)
  - Summary (subtotal, shipping, total)
  - Method dropdown (3 options)
  - Manual amount input
  - Error messages
- **Discount Modal** (lines 311-420): ~20 data-i18n attributes
  - Header, form fields (code input, type radios, value input)
  - All labels and help text
  - Summary section
  - Buttons

### email.js - JavaScript Critical Messages
1. **Line 115**: Attachment download error ‚Üí `t('email.attachmentError')`
2. **Lines 132-140**: Preview modal button tooltips ‚Üí data-i18n attributes
3. **Line 702**: Loading spinner ‚Üí `data-i18n="email.loadingEmail"`
4. **Line 457**: Large email loading ‚Üí `t('email.loadingLargeEmail').replace('{size}', sizeKB)`
5. **Lines 943-960**: Attachment validation errors (3 messages with interpolation)
6. **Line 1236**: Conversation history note ‚Üí `t('email.previousConversationHistory')`
7. **Lines 1545-1559**: Sidebar empty states (2 messages)
8. **Line 2159**: Association button loading ‚Üí `t('email.associating')`
9. **Line 2164**: ConversationId error ‚Üí `t('email.conversationIdNotFound')`
10. **Line 2182**: Order associated success ‚Üí `t('email.orderAssociatedSuccess')`
11. **Line 2189**: Association error ‚Üí `t('email.orderAssociationError').replace('{error}', ...)`
12. **Line 2194**: Restore button text ‚Üí `t('email.associateOrder')`
13. **Line 2558**: Send email error ‚Üí `t('email.sendError')`
14. **Line 3013**: Discount copied ‚Üí `t('email.discountCopied')`
15. **Line 3025**: Discount error ‚Üí `t('email.discountError')`
16. **Line 3029**: Restore discount button ‚Üí `t('email.createDiscountButton')`
17. **Line 3419**: Shopify ID not found ‚Üí `t('email.shopifyIdNotFound')`
18. **Line 3478**: Refund preview error ‚Üí `t('email.refundPreviewError')`
19. **Line 3533**: Refund calculation error ‚Üí `t('email.refundCalculationError')`
20. **Line 3702**: Refund transaction error ‚Üí `t('email.refundTransactionNotFound')`
21. **Line 3725**: Refund commit error ‚Üí `t('email.refundError')`
22. **Line 3731**: Refund success ‚Üí `t('email.refundSuccess')`
23. **Line 3742**: Refund error fallback ‚Üí `t('email.refundError')`

## üîÑ Trabajo Restante (Estimado ~30%)

### Dynamic HTML Generation (Funciones render*)
Las siguientes funciones generan HTML din√°micamente y necesitan data-i18n + t() calls:

1. **renderOrderCard()** (~lines 1593-1680)
   - Product names, status badges
   - "Reembolsado", "Total", "Tracking"
   - Match badges (matchedByEmail, matchedByPhone, matchedByOrder)
   
2. **renderMultipleOrdersSelector()** (~lines 1691-1725)
   - "M√∫ltiples pedidos encontrados"
   - "Selecciona un pedido..."
   - "Asociar pedido" button
   
3. **renderCustomerCard()** (~lines 1748-1800)
   - "Cliente sin nombre" fallback
   - Order count display
   
4. **renderOrderDetailsPanel()** (~lines 1806-1900)
   - Order details accordion content
   - Labels for order fields
   
5. **renderCustomerDetailsPanel()** (~lines 1912-1985)
   - Customer details accordion
   - Field labels
   
6. **renderConversationDetailsPanel()** (~lines 1987-2100)
   - Conversation details
   - Match information
   
7. **updateRefundSummary()** (~lines 3569-3650)
   - Dynamic summary text generation
   - Currency formatting labels
   
8. **updateDiscountSummary()** (~lines 2885-2950)
   - Discount summary text
   - Validation messages

### Validation Messages (Needs t() calls)
- Discount validation (empty code, invalid value, percent > 100)
- Refund validation (no items, no order, no location, shipping exceeded)
- Send validation (body too long, attachments too large)

### Console.logs (Low Priority)
- Internal debug messages (can be left in Spanish or removed)
- Only translate if they might be shown to users

## üìã Next Steps

### Estrategia Recomendada:
1. **Prioridad Alta**: Completar funciones render principales (renderOrderCard, renderCustomerCard, renderMultipleOrdersSelector)
2. **Prioridad Media**: Validation messages en modales (discount, refund)
3. **Prioridad Baja**: Console.logs y mensajes de debug internos

### Approach:
- Leer cada funci√≥n render completa
- Identificar strings hardcoded en espa√±ol
- Agregar keys a i18n.js si faltan
- Reemplazar con t() calls usando .replace() para interpolaci√≥n
- Agregar data-i18n a HTML generado donde corresponda

### Notas Importantes:
- **NUNCA** usar data-i18n en elementos con event listeners (usar t() manual + locale-changed listener)
- **SIEMPRE** usar .replace('{placeholder}', value) para valores din√°micos
- **VERIFICAR** que las keys existan en ambos idiomas (ES y EN)
- **TESTEAR** cambio de idioma en runtime para validar re-rendering

## üìä Progreso General
- **i18n keys**: ‚úÖ 100% (150+ keys, ES + EN)
- **HTML est√°tico**: ‚úÖ 100% (modales completos)
- **JS cr√≠tico (notificaciones/errores)**: ‚úÖ 100% (23 ubicaciones)
- **HTML din√°mico (render functions)**: ‚è≥ 0% (~8 funciones)
- **Validaciones**: ‚è≥ 0% (~15 mensajes)

**Progreso Total Estimado: ~70%**

---
*√öltima actualizaci√≥n: 2025-01-XX*
*Archivo generado para trackear progreso de i18n en email.js (3825 l√≠neas)*
